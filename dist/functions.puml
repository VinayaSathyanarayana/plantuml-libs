@startuml

' title

!procedure Title($title="", $subtitle="", $version="", $date="")
  !$s="$title"
  !$s_d="Last modified: " + %date("yyyy-MM-dd'T'HH:mm:ss")
  !$s_v=""
  !if ($date != "")
    !$s_d="Last modified: " + $date
  !endif
  !if ($version != "")
    !$s_v=" | version: " + $version
  !endif
  !$s=$s_d + $s_v
  left header
  !if ($title != "")
    <color:$FONT_COLOR><size:$FONT_SIZE_LG>$title</size></color>
  !endif
  !if ($subtitle)
    <color:$FONT_COLOR><size:$FONT_SIZE_MD>$subtitle</size></color>
  !endif
  <color:$FONT_COLOR_LIGHT><size:$FONT_SIZE_XS>$s</size></color>
  end header
!endprocedure

' icons

!function getIcon($name)
  !return $IMAGE_BASE_PATH/$name.$ICON_FORMAT
!endfunction

' library

!procedure include($resource)
  !include $LIB_BASE_LOCATION/$resource.puml
!endprocedure

' Relationship

!procedure Relationship($label="", $tech="")
  !if ($label != '' && $tech != '')
    $label\n<size:$FONT_SIZE_XS><color:$FONT_COLOR_LIGHT>[$tech]</color></size>
  !elseif ($label != '')
    $label
  !else
    <size:$FONT_SIZE_XS><color:$FONT_COLOR_LIGHT>[$tech]</color></size>
  !endif
!endprocedure

' Element

!procedure IconElement($id, $icon, $name="", $tech="")
  !local $H="<img:" + getIcon($icon)+ ">"
  !if ($name != "")
    !$H=$H + "\n" + $name
  !endif
  !if ($tech != "")
    !$H=$H + "\n" + "<size:" + $FONT_SIZE_XS + "><color:" + $FONT_COLOR_LIGHT + ">[" + $tech + "]</color></size>"
  !endif
  card $id <<IconElement>> as "$H"
!endprocedure

' Card

!procedure IconCard($id, $sprite="", $techName="", $funcName="", $content="")
  !local $V=""
  !local $H=""
  !local $S=""
  !local $F=""
  !if ($sprite != "")
    !$S="<color:" + $FONT_COLOR + ">" + $sprite + " </color>"
  !endif
  !if ($techName != "") && ($funcName != "")
    !$ST="<color:" + $FONT_COLOR_LIGHT + ">" + $techName + "</color>"
    !$T="<color:" + $FONT_COLOR + ">" + $funcName + "</color>"
    !$H=$T + "\l" + $S + $ST
    !$V=$V + $H
  !elseif ($techName != "")
    !$ST="<color:" + $FONT_COLOR + ">" + $techName + "</color>"
    !$H=$S + $ST
    !$V=$V + $H
  !elseif ($funcName != "")
    !$T=$S + "<color:" + $FONT_COLOR + ">" + $funcName + "</color>"
    !$H=$T
    !$V=$V + $H
  !endif
  !if ($H != "") && ($content != "")
    !$F="\l----\l<size:" + $FONT_SIZE_SM + ">" + $content + "</size>"
    !$V=$V + $F
  !elseif ($content != "")
    !$F="\l<size:" + $FONT_SIZE_SM + " + $content + "</size>"
    !$V=$V + $F
  !endif
  Rectangle $id <<IconCard>> as "$V"
!endprocedure

' Group

!procedure IconGroup($id, $stereotype, $sprite, $name="", $tech="")
  !local $value=""
  !if ($sprite)
    !$value=$sprite + " "
  !endif

  !if ($name != "") && ($tech != "")
    !$value=$value + $name + "\n" + "<size:" + $FONT_SIZE_XS + "><color:" + $FONT_COLOR_LIGHT + ">[" + $tech + "]</color></size>"
  !elseif ($name != "")
    !$value=$value + $name
  !elseif ($tech != "")
    !$value=$value + "<size:" + $FONT_SIZE_XS + "><color:" + $FONT_COLOR_LIGHT + ">[" + $tech + "]</color></size>"
  !endif

  !if ($value != "")
    Rectangle $id <<$stereotype>> as "$value"
  !else
    Rectangle $id <<$stereotype>>
  !endif
!endprocedure

@enduml